<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Building systems with SERV &#8212; SERV  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=12dfc556" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="https://wavedrom.com/skins/default.js"></script>
    <script src="https://wavedrom.com/wavedrom.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Internals" href="internals.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="building-systems-with-serv">
<h1>Building systems with SERV<a class="headerlink" href="#building-systems-with-serv" title="Link to this heading">¶</a></h1>
<p>A CPU is only as good as its ecosystem. In order to make use of SERV, it needs to be combined with other components such as memories, accelerators and peripheral controllers.</p>
<p>Welcome to the reservoir, a pool of ready-made designs and subsystems for different purposes that you can use to quickly get started with SERV or integrate it into larger designs.</p>
<section id="servile-convenience-wrapper">
<h2>Servile : Convenience wrapper<a class="headerlink" href="#servile-convenience-wrapper" title="Link to this heading">¶</a></h2>
<figure class="align-default" id="id3">
<img alt="_images/servile.png" src="_images/servile.png" />
<figcaption>
<p><span class="caption-text">Servile convenience wrapper</span><a class="headerlink" href="#id3" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Servile is a helper component that takes care of common configuration and is used as a building block in the other designs and subsystems. It exposes a memory bus intended to be connected to a combined data and instruction memory, an extension bus for peripheral controllers and accelerators and an RF interface for connecting to an SRAM for GPR and CSR registers.</p>
<figure class="align-default" id="id4">
<img alt="_images/servile_int.png" src="_images/servile_int.png" />
<figcaption>
<p><span class="caption-text">Servile block diagram</span><a class="headerlink" href="#id4" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Internally, Servile contains logic for optionally instantiating an MDU core for the M extension, an arbiter to route instruction fetches and main memory accesses through the same interface and a mux to split up the memory map into memory (0x00000000-0x3FFFFFFF) and external accesses (0x40000000-0xFFFFFFFF). The mux also contains simulation-only logic to write output to a log file and stop the simulation.</p>
<section id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h3>
<table class="docutils align-default" id="id5">
<caption><span class="caption-text">Parameters</span><a class="headerlink" href="#id5" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 9.1%" />
<col style="width: 18.2%" />
<col style="width: 72.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Values</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>reset_pc</p></td>
<td><p>0x00000000 (default) - 0xFFFFFFFC</p></td>
<td><p>Address of first instruction to fetch from memory after reset (Reset vector)</p></td>
</tr>
<tr class="row-odd"><td><p>reset_strategy</p></td>
<td><p>“MINI” (default), “NONE”</p></td>
<td><div class="line-block">
<div class="line">Amount of reset applied to design</div>
<div class="line">“NONE” : No reset at all. Relies on a POR to set correct initialization values and that core isn’t reset during runtime</div>
<div class="line">“MINI” : Standard setting. Resets the minimal amount of FFs needed to restart execution from the instruction at RESET_PC.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>rf_width</p></td>
<td><p>2 (default), 4, 8, 16, 32</p></td>
<td><p>Width of the data bus to the RF memory. Typically smaller values use less resources, but can be implementation-dependant.</p></td>
</tr>
<tr class="row-odd"><td><p>sim</p></td>
<td><p>0 (default), 1</p></td>
<td><div class="line-block">
<div class="line">Enable simulation mode. In simulation mode, two memory addresses have special purposes.</div>
<div class="line">0x80000000: Writes to this address puts the byte in the lowest data byte into a log file decided by the “signature” plusarg.</div>
<div class="line">0x90000000: Writes to this address ends the simulation.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>with_c</p></td>
<td><p>0 (default), 1</p></td>
<td><p>Enable the C extension. This also makes SERV support misaligned loads and stores.</p></td>
</tr>
<tr class="row-odd"><td><p>with_csr</p></td>
<td><p>0 (default), 1</p></td>
<td><p>Enable the Zicsr extension. This also enables timer IRQ and exception handling. Note that SERV only implements a small subset of the CSR registers.</p></td>
</tr>
<tr class="row-even"><td><p>with_mdu</p></td>
<td><p>0 (default), 1</p></td>
<td><p>Enables the Multiplication and Division Unit (MDU) to support the M extension. Note that this only enables the interface and the decoder logic. The MDU itself is external from SERV.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="signals">
<h3>Signals<a class="headerlink" href="#signals" title="Link to this heading">¶</a></h3>
<table class="docutils align-default" id="id6">
<caption><span class="caption-text">Signals</span><a class="headerlink" href="#id6" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 25.0%" />
<col style="width: 8.3%" />
<col style="width: 4.2%" />
<col style="width: 62.5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Signal</p></th>
<th class="head"><p>Width</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>i_clk</p></td>
<td><p>1</p></td>
<td><p>in</p></td>
<td><p>Clock</p></td>
</tr>
<tr class="row-odd"><td><p>i_rst</p></td>
<td><p>1</p></td>
<td><p>in</p></td>
<td><p>Synchronous reset</p></td>
</tr>
<tr class="row-even"><td><p>i_timer_irq</p></td>
<td><p>1</p></td>
<td><p>in</p></td>
<td><p>Timer interrupt</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Memory interface</strong></p></td>
<td></td>
<td></td>
<td><p>Connect to instruction/data memory</p></td>
</tr>
<tr class="row-even"><td><p>o_wb_mem_adr</p></td>
<td><p>32</p></td>
<td><p>out</p></td>
<td><p>Memory bus address</p></td>
</tr>
<tr class="row-odd"><td><p>o_wb_mem_dat</p></td>
<td><p>32</p></td>
<td><p>out</p></td>
<td><p>Memory bus data</p></td>
</tr>
<tr class="row-even"><td><p>o_wb_mem_sel</p></td>
<td><p>4</p></td>
<td><p>out</p></td>
<td><p>Memory bus write data byte select mask</p></td>
</tr>
<tr class="row-odd"><td><p>o_wb_mem_we</p></td>
<td><p>1</p></td>
<td><p>out</p></td>
<td><p>Memory bus write transaction</p></td>
</tr>
<tr class="row-even"><td><p>o_wb_mem_stb</p></td>
<td><p>1</p></td>
<td><p>out</p></td>
<td><p>Memory bus active strobe</p></td>
</tr>
<tr class="row-odd"><td><p>i_wb_mem_rdt</p></td>
<td><p>32</p></td>
<td><p>in</p></td>
<td><p>Memory bus read data</p></td>
</tr>
<tr class="row-even"><td><p>i_wb_mem_ack</p></td>
<td><p>1</p></td>
<td><p>in</p></td>
<td><p>Memory bus cycle acknowledged</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Extension interface</strong></p></td>
<td></td>
<td></td>
<td><p>Connect to peripheral controllers</p></td>
</tr>
<tr class="row-even"><td><p>o_wb_ext_adr</p></td>
<td><p>32</p></td>
<td><p>out</p></td>
<td><p>Data bus address</p></td>
</tr>
<tr class="row-odd"><td><p>o_wb_ext_dat</p></td>
<td><p>32</p></td>
<td><p>out</p></td>
<td><p>Data bus write data</p></td>
</tr>
<tr class="row-even"><td><p>o_wb_ext_sel</p></td>
<td><p>4</p></td>
<td><p>out</p></td>
<td><p>Data bus write data byte select mask</p></td>
</tr>
<tr class="row-odd"><td><p>o_wb_ext_we</p></td>
<td><p>1</p></td>
<td><p>out</p></td>
<td><p>Data bus write transaction</p></td>
</tr>
<tr class="row-even"><td><p>o_wb_ext_stb</p></td>
<td><p>1</p></td>
<td><p>out</p></td>
<td><p>Data bus active cycle</p></td>
</tr>
<tr class="row-odd"><td><p>i_wb_ext_rdt</p></td>
<td><p>32</p></td>
<td><p>in</p></td>
<td><p>Data bus return data</p></td>
</tr>
<tr class="row-even"><td><p>i_wb_ext_ack</p></td>
<td><p>1</p></td>
<td><p>in</p></td>
<td><p>Data bus return data valid</p></td>
</tr>
<tr class="row-odd"><td><p><strong>RF (SRAM) interface</strong></p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>o_rf_waddr</p></td>
<td><p>ceil(log2(regs*32/rf_width)</p></td>
<td><p>out</p></td>
<td><p>RF memory write address</p></td>
</tr>
<tr class="row-odd"><td><p>o_rf_wdata</p></td>
<td><p>rf_width</p></td>
<td><p>out</p></td>
<td><p>RF memory write data</p></td>
</tr>
<tr class="row-even"><td><p>o_rf_wen</p></td>
<td><p>1</p></td>
<td><p>out</p></td>
<td><p>RF memory write enable</p></td>
</tr>
<tr class="row-odd"><td><p>o_rf_raddr</p></td>
<td><p>ceil(log2(regs*32/rf_width)</p></td>
<td><p>out</p></td>
<td><p>RF memory read address</p></td>
</tr>
<tr class="row-even"><td><p>i_rf_rdata</p></td>
<td><p>rf_width</p></td>
<td><p>out</p></td>
<td><p>RF memory read data</p></td>
</tr>
<tr class="row-odd"><td><p>o_rf_ren</p></td>
<td><p>1</p></td>
<td><p>out</p></td>
<td><p>RF memory read enable</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="serving-fpga-subsystem">
<h2>Serving : FPGA subsystem<a class="headerlink" href="#serving-fpga-subsystem" title="Link to this heading">¶</a></h2>
<figure class="align-default" id="id7">
<img alt="_images/serving.png" src="_images/serving.png" />
<figcaption>
<p><span class="caption-text">Serving SoClet</span><a class="headerlink" href="#id7" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Serving is ideal for FPGA implementations as it only uses a single combined block RAM for instructions, data and RF that can be preloaded with a RISC-V application. It exposes a wishbone data bus that can be used to connect peripheral controllers.</p>
<section id="id1">
<h3>Parameters<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<table class="docutils align-default" id="id8">
<caption><span class="caption-text">Parameters</span><a class="headerlink" href="#id8" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 9.1%" />
<col style="width: 18.2%" />
<col style="width: 72.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Values</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>memfile</p></td>
<td><p>“” (default)</p></td>
<td><p>Verilog hex file containing a RISC-V application to be preloaded into memory</p></td>
</tr>
<tr class="row-odd"><td><p>memsize</p></td>
<td><p>1-4294967296 (default 8192)</p></td>
<td><p>Size of memory (in bytes). Needs to be at least large enough to fit the application supplied by memsize. Note that the RF occupies the highest 128 bytes of memory in the RAM.</p></td>
</tr>
<tr class="row-even"><td><p>sim</p></td>
<td><p>0 (default), 1</p></td>
<td><div class="line-block">
<div class="line">Enable simulation mode. In simulation mode, two memory addresses have special purposes.</div>
<div class="line">0x80000000: Writes to this address puts the byte in the lowest data byte into a log file decided by the “signature” plusarg.</div>
<div class="line">0x90000000: Writes to this address ends the simulation.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>RESET_STRATEGY</p></td>
<td><p>“MINI” (default), “NONE”</p></td>
<td><div class="line-block">
<div class="line">Amount of reset applied to design</div>
<div class="line">“NONE” : No reset at all. Relies on a POR to set correct initialization values and that core isn’t reset during runtime</div>
<div class="line">“MINI” : Standard setting. Resets the minimal amount of FFs needed to restart execution from the instruction at RESET_PC.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>WITH_CSR</p></td>
<td><p>0 (default), 1</p></td>
<td><p>Enable the Zicsr extension. This also enables timer IRQ and exception handling. Note that SERV only implements a small subset of the CSR registers.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id2">
<h3>Signals<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<table class="docutils align-default" id="id9">
<caption><span class="caption-text">Signals</span><a class="headerlink" href="#id9" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 25.0%" />
<col style="width: 8.3%" />
<col style="width: 4.2%" />
<col style="width: 62.5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Signal</p></th>
<th class="head"><p>Width</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>i_clk</p></td>
<td><p>1</p></td>
<td><p>in</p></td>
<td><p>Clock</p></td>
</tr>
<tr class="row-odd"><td><p>i_rst</p></td>
<td><p>1</p></td>
<td><p>in</p></td>
<td><p>Synchronous reset</p></td>
</tr>
<tr class="row-even"><td><p>i_timer_irq</p></td>
<td><p>1</p></td>
<td><p>in</p></td>
<td><p>Timer interrupt</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Extension interface</strong></p></td>
<td></td>
<td></td>
<td><p>Connect to peripheral controllers</p></td>
</tr>
<tr class="row-even"><td><p>o_wb_adr</p></td>
<td><p>32</p></td>
<td><p>out</p></td>
<td><p>Data bus address</p></td>
</tr>
<tr class="row-odd"><td><p>o_wb_dat</p></td>
<td><p>32</p></td>
<td><p>out</p></td>
<td><p>Data bus write data</p></td>
</tr>
<tr class="row-even"><td><p>o_wb_sel</p></td>
<td><p>4</p></td>
<td><p>out</p></td>
<td><p>Data bus write data byte select mask</p></td>
</tr>
<tr class="row-odd"><td><p>o_wb_we</p></td>
<td><p>1</p></td>
<td><p>out</p></td>
<td><p>Data bus write transaction</p></td>
</tr>
<tr class="row-even"><td><p>o_wb_cyc</p></td>
<td><p>1</p></td>
<td><p>out</p></td>
<td><p>Data bus active cycle</p></td>
</tr>
<tr class="row-odd"><td><p>i_wb_rdt</p></td>
<td><p>32</p></td>
<td><p>in</p></td>
<td><p>Data bus return data</p></td>
</tr>
<tr class="row-even"><td><p>i_wb_ack</p></td>
<td><p>1</p></td>
<td><p>in</p></td>
<td><p>Data bus return data valid</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="servant-fpga-reference-platform">
<h2>Servant : FPGA Reference platform<a class="headerlink" href="#servant-fpga-reference-platform" title="Link to this heading">¶</a></h2>
<figure class="align-default" id="id10">
<img alt="_images/servant.png" src="_images/servant.png" />
<figcaption>
<p><span class="caption-text">Servant FPGA Reference platform</span><a class="headerlink" href="#id10" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>SERV comes with a small FPGA-focused reference platform called Servant, which is capable of running Zephyr RTOS, the regression test suite and other software. The platform consists of SERV, a timer, memory and a 1-bit GPIO output pin.</p>
<section id="available-targets">
<h3>Available targets<a class="headerlink" href="#available-targets" title="Link to this heading">¶</a></h3>
<p>The servant SoC has been ported to an increasing number of different FPGA boards and is easy to modify for new targets. To see all currently supported targets run:</p>
<blockquote>
<div><p>fusesoc core show servant</p>
</div></blockquote>
<p>By default, these targets have the program memory preloaded with a small Zephyr hello world example that writes its output on a UART pin. Don’t forget to install the appropriate toolchain (e.g. icestorm, Vivado, Quartus…) and add to your PATH</p>
<p>Some targets also depend on functionality in the FuseSoC base library (fusesoc-cores). Running <cite>fusesoc library list</cite> should tell you if fusesoc-cores is already available. If not, add it to your workspace with</p>
<blockquote>
<div><p>fusesoc library add fusesoc-cores <a class="reference external" href="https://github.com/fusesoc/fusesoc-cores">https://github.com/fusesoc/fusesoc-cores</a></p>
</div></blockquote>
<p>Now we’re ready to build. Note, for all the cases below, it’s possible to run with <cite>–memfile=$SERV/sw/blinky.hex</cite>
(or any other suitable program) as the last argument to preload the LED blink example
instead of hello world.</p>
<section id="ac701">
<h4>AC701<a class="headerlink" href="#ac701" title="Link to this heading">¶</a></h4>
<blockquote>
<div><p>fusesoc run –target=ac701 servant</p>
</div></blockquote>
</section>
<section id="alchistry-au">
<h4>Alchistry AU<a class="headerlink" href="#alchistry-au" title="Link to this heading">¶</a></h4>
<blockquote>
<div><p>fusesoc run –target=alchistry_au servant</p>
</div></blockquote>
</section>
<section id="alhambra-ii">
<h4>Alhambra II<a class="headerlink" href="#alhambra-ii" title="Link to this heading">¶</a></h4>
<p>Pin 61 is used for UART output with 115200 baud rate. This pin is connected to a FT2232H chip in board, that manages the communications between the FPGA and the computer.</p>
<blockquote>
<div><p>fusesoc run –target=alhambra servant
iceprog -d i:0x0403:0x6010:0 build/servant_1.0.1/alhambra-icestorm/servant_1.0.1.bin</p>
</div></blockquote>
</section>
<section id="alinx-ax309-spartan6-lx9">
<h4>Alinx ax309 (Spartan6 LX9)<a class="headerlink" href="#alinx-ax309-spartan6-lx9" title="Link to this heading">¶</a></h4>
<p>Pin D12 (the on-board RS232 TX pin) is used for UART output with 115200 baud rate and wired to Pin P4 (LED0).</p>
<blockquote>
<div><p>fusesoc run –target=ax309 servant</p>
</div></blockquote>
</section>
<section id="arty-a7-35t">
<h4>Arty A7 35T<a class="headerlink" href="#arty-a7-35t" title="Link to this heading">¶</a></h4>
<p>Pin D10 (uart_rxd_out) is used for UART output with 57600 baud rate (to use
blinky.hex change D10 to H5 (led[4]) in data/arty_a7_35t.xdc).</p>
<blockquote>
<div><p>fusesoc run –target=arty_a7_35t servant</p>
</div></blockquote>
</section>
<section id="arty-s7-50t">
<h4>Arty S7 50T<a class="headerlink" href="#arty-s7-50t" title="Link to this heading">¶</a></h4>
<p>Pin R12 (uart_rxd_out) is used for UART output with 57600 baud rate (to use
blinky.hex change R12 to E18 (led[4]) in data/arty_s7_50t.xdc).</p>
<blockquote>
<div><p>fusesoc run –target=arty_s7_50t servant</p>
</div></blockquote>
</section>
<section id="chameleon96-arrow-96-cv-soc-board">
<h4>Chameleon96 (Arrow 96 CV SoC Board)<a class="headerlink" href="#chameleon96-arrow-96-cv-soc-board" title="Link to this heading">¶</a></h4>
<p>FPGA Pin W14 (1V8, pin 5 low speed connector) is used for UART Tx output with 115200 baud rate. No reset key. Yellow Wifi led is q output.</p>
<blockquote>
<div><p>fusesoc run –target=chameleon96 servant</p>
</div></blockquote>
</section>
<section id="cmod-a7-35t">
<h4>CMOD A7 35t<a class="headerlink" href="#cmod-a7-35t" title="Link to this heading">¶</a></h4>
<p>FPGA Pin J18 is used for UART output with 57600 baud rate. btn0 is used for reset.</p>
<blockquote>
<div><p>fusesoc run –target=cmod_a7_35t servant</p>
</div></blockquote>
</section>
<section id="cyc1000">
<h4>CYC1000<a class="headerlink" href="#cyc1000" title="Link to this heading">¶</a></h4>
<blockquote>
<div><p>fusesoc run –target=cyc1000 servant</p>
</div></blockquote>
</section>
<section id="de0-nano">
<h4>DE0 Nano<a class="headerlink" href="#de0-nano" title="Link to this heading">¶</a></h4>
<p>FPGA Pin D11 (Connector JP1, pin 38) is used for UART output with 57600 baud rate. DE0 Nano needs an external 3.3V UART to connect to this pin</p>
<blockquote>
<div><p>fusesoc run –target=de0_nano servant</p>
</div></blockquote>
</section>
<section id="de10-nano">
<h4>DE10 Nano<a class="headerlink" href="#de10-nano" title="Link to this heading">¶</a></h4>
<p>FPGA Pin Y15 (Connector JP7, pin 1) is used for UART output with 57600 baud rate. DE10 Nano needs an external 3.3V UART to connect to this pin</p>
<blockquote>
<div><p>fusesoc run –target=de10_nano servant</p>
</div></blockquote>
</section>
<section id="de1-soc-revf">
<h4>DE1 SoC revF<a class="headerlink" href="#de1-soc-revf" title="Link to this heading">¶</a></h4>
<p>FPGA PIN_AC18 (Connector GPIO0, pin 0) is used for UART output with 57600 baud rate. DE1 SoC revF needs an external 3.3V UART to connect to this pin. The UART pin has not been tested.</p>
<blockquote>
<div><p>fusesoc run –target=de1_soc_revF servant</p>
</div></blockquote>
</section>
<section id="deca-development-kit">
<h4>DECA development kit<a class="headerlink" href="#deca-development-kit" title="Link to this heading">¶</a></h4>
<p>FPGA Pin W18 (Pin 3 P8 connector) is used for UART output with 57600 baud rate. Key 0 is reset and Led 0 q output.</p>
<blockquote>
<div><p>fusesoc run –target=deca servant</p>
</div></blockquote>
</section>
<section id="ebaz4205-development-board">
<h4>EBAZ4205 ‘Development’ Board<a class="headerlink" href="#ebaz4205-development-board" title="Link to this heading">¶</a></h4>
<p>Pin B20 is used for UART output with 57600 baud rate. To use <cite>blinky.hex</cite>
change B20 to W14 (red led) in <cite>data/ebaz4205.xdc</cite> file).</p>
<blockquote>
<div><p>fusesoc run –target=ebaz4205 servant</p>
<p>fusesoc run –target=ebaz4205 servant –memfile=$SERV/sw/blinky.hex</p>
</div></blockquote>
<p>Reference: <a class="reference external" href="https://github.com/fusesoc/blinky#ebaz4205-development-board">https://github.com/fusesoc/blinky#ebaz4205-development-board</a></p>
</section>
<section id="ecp5-evn">
<h4>ECP5 EVN<a class="headerlink" href="#ecp5-evn" title="Link to this heading">¶</a></h4>
<blockquote>
<div><p>fusesoc run –target=ecp5_evn servant</p>
</div></blockquote>
</section>
<section id="icebreaker">
<h4>Icebreaker<a class="headerlink" href="#icebreaker" title="Link to this heading">¶</a></h4>
<p>Pin 9 is used for UART output with 57600 baud rate.</p>
<blockquote>
<div><p>fusesoc run –target=icebreaker servant</p>
</div></blockquote>
</section>
<section id="icestick">
<h4>iCEstick<a class="headerlink" href="#icestick" title="Link to this heading">¶</a></h4>
<p>Pin 95 is used as the GPIO output which is connected to the board’s green LED. Due to this board’s limited Embedded BRAM, programs with a maximum of 7168 bytes can be loaded. The default program for this board is blinky.hex.</p>
<blockquote>
<div><p>fusesoc run –target=icestick servant
iceprog build/servant_1.2.1/icestick-icestorm/servant_1.2.1.bin</p>
</div></blockquote>
</section>
<section id="icesugar">
<h4>iCESugar<a class="headerlink" href="#icesugar" title="Link to this heading">¶</a></h4>
<p>Pin 6 is used for UART output with 115200 baud rate. Thanks to the onboard
debugger, you can just connect the USB Type-C connector to the PC, and a
serial console will show up.</p>
<blockquote>
<div><p>fusesoc run –target=icesugar servant</p>
</div></blockquote>
</section>
<section id="ice-v-wireless">
<h4>ICE-V Wireless<a class="headerlink" href="#ice-v-wireless" title="Link to this heading">¶</a></h4>
<p>Pin 9 is used for UART output with 57600 baud rate.</p>
<blockquote>
<div><p>fusesoc run –target=icev_wireless servant</p>
<p>iceprog build/servant_1.2.1/icestick-icestorm/servant_1.2.1.bin</p>
</div></blockquote>
</section>
<section id="gmm7550">
<h4>GMM7550<a class="headerlink" href="#gmm7550" title="Link to this heading">¶</a></h4>
<blockquote>
<div><p>fusesoc run –target=gmm7550 servant</p>
</div></blockquote>
</section>
<section id="lx9-microboard">
<h4>LX9 Microboard<a class="headerlink" href="#lx9-microboard" title="Link to this heading">¶</a></h4>
<blockquote>
<div><p>fusesoc run –target=lx9_microboard servant</p>
</div></blockquote>
</section>
<section id="machdyne-kolibri">
<h4>Machdyne Kolibri<a class="headerlink" href="#machdyne-kolibri" title="Link to this heading">¶</a></h4>
<p>Pin B1 is used for UART output with 115200 baud rate. The serial port on Kolibri is accessible as a USB-CDC device.</p>
<blockquote>
<div><p>fusesoc run –target=machdyne_kolibri servant</p>
<p>ldprog -Ks build/servant_1.2.1/machdyne_kolibri-icestorm/servant_1.2.1.bin</p>
</div></blockquote>
</section>
<section id="max10-10m08-evaluation-kit">
<h4>MAX10 10M08 Evaluation Kit<a class="headerlink" href="#max10-10m08-evaluation-kit" title="Link to this heading">¶</a></h4>
<p>FPGA Pin 75 (Arduino_IO01 J5 pin 7) is used for UART output with 57600 baud rate. SW1 is reset and Led 1 q output.</p>
<blockquote>
<div><p>fusesoc run –target=max10_10m08evk servant</p>
</div></blockquote>
</section>
<section id="nandland-go-board">
<h4>Nandland Go Board<a class="headerlink" href="#nandland-go-board" title="Link to this heading">¶</a></h4>
<p>Pin 56 is used as the GPIO output which is connected to the board’s LED1. Due to this board’s limited Embedded BRAM, programs with a maximum of 7168 bytes can be loaded. The default program for this board is blinky.hex.</p>
<blockquote>
<div><p>fusesoc run –target=go_board servant
iceprog build/servant_1.2.1/go_board-icestorm/servant_1.2.1.bin</p>
</div></blockquote>
</section>
<section id="nexys-2">
<h4>Nexys 2<a class="headerlink" href="#nexys-2" title="Link to this heading">¶</a></h4>
<p>Pmod pin JA1 is connected to UART tx with 57600 baud rate. A USB to TTL connector is used to display to hello world message on the serial monitor.
(To use blinky.hex change L15 to J14 (led[0]) in data/nexys_2.ucf).</p>
<blockquote>
<div><p>fusesoc run –target=nexys_2_500 servant –uart_baudrate=57600 –firmware=$SERV/sw/zephyr_hello.hex</p>
</div></blockquote>
</section>
<section id="nexys-a7">
<h4>Nexys A7<a class="headerlink" href="#nexys-a7" title="Link to this heading">¶</a></h4>
<blockquote>
<div><p>fusesoc run –target=nexys_a7 servant</p>
</div></blockquote>
</section>
<section id="orangecrab-r0-2">
<h4>OrangeCrab R0.2<a class="headerlink" href="#orangecrab-r0-2" title="Link to this heading">¶</a></h4>
<p>Pin D1 is used for UART output with 115200 baud rate.</p>
<blockquote>
<div><p>fusesoc run –target=orangecrab_r0.2 servant
dfu-util -d 1209:5af0 -D build/servant_1.2.1/orangecrab_r0.2-trellis/servant_1.2.1.bit</p>
</div></blockquote>
</section>
<section id="polarfire-splash-kit">
<h4>PolarFire Splash Kit<a class="headerlink" href="#polarfire-splash-kit" title="Link to this heading">¶</a></h4>
<p>Pin R5 is used for UART output with a 115200 baud rate, this is routed through
the onboard FTDI transceiver. LED1 (Pin P7) serves as the generic GPIO.</p>
<p>Pin P8 is used as the GPIO heartbeat with a 1Hz frequency and is connected to
the board’s LED2.</p>
<p>Pin N4 (user reset) is used for the reset</p>
<blockquote>
<div><p>fusesoc run –target=polarfire_splashkit servant –memfile=$SERV/sw/zephyr_hello.hex</p>
</div></blockquote>
</section>
<section id="saanlima-pipistrello-spartan6-lx45">
<h4>Saanlima Pipistrello (Spartan6 LX45)<a class="headerlink" href="#saanlima-pipistrello-spartan6-lx45" title="Link to this heading">¶</a></h4>
<p>Pin A10 (usb_data&lt;1&gt;) is used for UART output with 57600 baud rate (to use
blinky.hex change A10 to V16 (led[0]) in data/pipistrello.ucf).</p>
<blockquote>
<div><p>fusesoc run –target=pipistrello servant</p>
</div></blockquote>
</section>
<section id="sockit-development-kit">
<h4>SoCKit development kit<a class="headerlink" href="#sockit-development-kit" title="Link to this heading">¶</a></h4>
<p>FPGA Pin F14 (HSTC GPIO addon connector J2, pin 2) is used for UART output with 57600 baud rate.</p>
<blockquote>
<div><p>fusesoc run –target=sockit servant</p>
</div></blockquote>
</section>
<section id="tinyfpga-bx">
<h4>TinyFPGA BX<a class="headerlink" href="#tinyfpga-bx" title="Link to this heading">¶</a></h4>
<p>Pin A6 is used for UART output with 115200 baud rate.</p>
<blockquote>
<div><p>fusesoc run –target=tinyfpga_bx servant
tinyprog –program build/servant_1.0.1/tinyfpga_bx-icestorm/servant_1.0.1.bin</p>
</div></blockquote>
</section>
<section id="ulx3s">
<h4>ULX3S<a class="headerlink" href="#ulx3s" title="Link to this heading">¶</a></h4>
<blockquote>
<div><p>fusesoc run –target=ulx3s servant</p>
</div></blockquote>
</section>
<section id="upduino2">
<h4>Upduino2<a class="headerlink" href="#upduino2" title="Link to this heading">¶</a></h4>
<blockquote>
<div><p>fusesoc run –target=upduino2 servant</p>
</div></blockquote>
</section>
<section id="zcu106">
<h4>zcu106<a class="headerlink" href="#zcu106" title="Link to this heading">¶</a></h4>
<blockquote>
<div><p>fusesoc run –target=zcu106 servant</p>
</div></blockquote>
</section>
</section>
<section id="porting-servant-to-a-new-target">
<h3>Porting Servant to a new target<a class="headerlink" href="#porting-servant-to-a-new-target" title="Link to this heading">¶</a></h3>
<p>Mostly any FPGA board can be used to run the Servant SoC. In its simplest form it just needs an FPGA with a clock input and an output that can be used to connect an UART or a LED.</p>
<p>The porting process consists of FIXME steps.
We will use <cite>&lt;name&gt;</cite> as a placeholder for the name of the FPGA board.
1. Locate the pins used for clock input and for the outputs. Outputs should preferably be both a LED and an UART, but either works if not both are available. Optionally, locate an input pin connected to the reset as well. This is not required, but can be handy.
2. Write a pin constraints file with your located pins in the format of the FPGA toolchain you intend to use. For Vivado this would be an .xdc file. For Quartus a .tcl file, for nextpnr a .pcf file and so on. Save this as <cite>data/&lt;name&gt;.{pcf,ucf,xdc…}</cite> in the SERV repo.
3. Create a clock generation file
4. Create a top-level
5. Create a fileset
6. Create a target</p>
</section>
</section>
</section>

    <script type="text/javascript">
        function init() {
            WaveDrom.ProcessAll();
        }
        window.onload = init;
    </script>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">SERV</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="datasheet.html">Datasheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="internals.html">Internals</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Building systems with SERV</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#servile-convenience-wrapper">Servile : Convenience wrapper</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#signals">Signals</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#serving-fpga-subsystem">Serving : FPGA subsystem</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Signals</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#servant-fpga-reference-platform">Servant : FPGA Reference platform</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#available-targets">Available targets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ac701">AC701</a></li>
<li class="toctree-l4"><a class="reference internal" href="#alchistry-au">Alchistry AU</a></li>
<li class="toctree-l4"><a class="reference internal" href="#alhambra-ii">Alhambra II</a></li>
<li class="toctree-l4"><a class="reference internal" href="#alinx-ax309-spartan6-lx9">Alinx ax309 (Spartan6 LX9)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#arty-a7-35t">Arty A7 35T</a></li>
<li class="toctree-l4"><a class="reference internal" href="#arty-s7-50t">Arty S7 50T</a></li>
<li class="toctree-l4"><a class="reference internal" href="#chameleon96-arrow-96-cv-soc-board">Chameleon96 (Arrow 96 CV SoC Board)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cmod-a7-35t">CMOD A7 35t</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cyc1000">CYC1000</a></li>
<li class="toctree-l4"><a class="reference internal" href="#de0-nano">DE0 Nano</a></li>
<li class="toctree-l4"><a class="reference internal" href="#de10-nano">DE10 Nano</a></li>
<li class="toctree-l4"><a class="reference internal" href="#de1-soc-revf">DE1 SoC revF</a></li>
<li class="toctree-l4"><a class="reference internal" href="#deca-development-kit">DECA development kit</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ebaz4205-development-board">EBAZ4205 ‘Development’ Board</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ecp5-evn">ECP5 EVN</a></li>
<li class="toctree-l4"><a class="reference internal" href="#icebreaker">Icebreaker</a></li>
<li class="toctree-l4"><a class="reference internal" href="#icestick">iCEstick</a></li>
<li class="toctree-l4"><a class="reference internal" href="#icesugar">iCESugar</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ice-v-wireless">ICE-V Wireless</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gmm7550">GMM7550</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lx9-microboard">LX9 Microboard</a></li>
<li class="toctree-l4"><a class="reference internal" href="#machdyne-kolibri">Machdyne Kolibri</a></li>
<li class="toctree-l4"><a class="reference internal" href="#max10-10m08-evaluation-kit">MAX10 10M08 Evaluation Kit</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nandland-go-board">Nandland Go Board</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nexys-2">Nexys 2</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nexys-a7">Nexys A7</a></li>
<li class="toctree-l4"><a class="reference internal" href="#orangecrab-r0-2">OrangeCrab R0.2</a></li>
<li class="toctree-l4"><a class="reference internal" href="#polarfire-splash-kit">PolarFire Splash Kit</a></li>
<li class="toctree-l4"><a class="reference internal" href="#saanlima-pipistrello-spartan6-lx45">Saanlima Pipistrello (Spartan6 LX45)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sockit-development-kit">SoCKit development kit</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tinyfpga-bx">TinyFPGA BX</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ulx3s">ULX3S</a></li>
<li class="toctree-l4"><a class="reference internal" href="#upduino2">Upduino2</a></li>
<li class="toctree-l4"><a class="reference internal" href="#zcu106">zcu106</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#porting-servant-to-a-new-target">Porting Servant to a new target</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="internals.html" title="previous chapter">Internals</a></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2020, Olof Kindgren.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/reservoir.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>